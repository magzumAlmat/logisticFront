# Документация Frontend части проекта CRM

## Технологии и пакеты

- Next.js 14.0.4
- MUI
- React Redux Toolkit
- RTK Query (для удаленных состояний)
- exceljs (экспорт эксель файлов)
- xlsx (для превью эксель файлов)

## Как запускать проект

1. Нужно скачать проект. Обновить пакеты через команду:

```js
npm install
```

2. Запуск в режиме разработчика:

```js
npm run dev
```

## Запуск в production

Для начала нужно проверить файл api.js в папке services. В этом файле есть baseUrl для подключения к бэкенду. Убедитесь, что он корректен. После вводим команды:

```js
npm run build
npm start
```

## Структура проекта

### Страницы (папка app):

- `app/(root)` - только для видимого разделения, внутри находятся все страницы, которые требуют аутентификацию
- `app/login` - страница для входа в систему
- `app/(root)/companies` - страница с компаниями, они едины для всех модулей системы
- `app/(root)/admin` - страница управления пользователями для администратора

- `app/(root)/(auto)` - страница для видимого разделения, внутри находятся все страницы, которые относятся к модулю Авто
- `app/(root)/(auto)/auto-proposals` - страница с заявками авто
- `app/(root)/(auto)/auto-warehouses` - страница с заявками, разделенные по складам
- `app/(root)/(auto)/auto-basket` - страница с загрузочными листами
- `app/(root)/(auto)/auto-archive` - страница с архивными заявками

- `app/(root)/(railway)` - страница для видимого разделения, внутри находятся все страницы, которые относятся к модулю ЖД

- `app/(root)/(railway)/railway-proposals` - страница с заявками жд
- `app/(root)/(railway)/railway-warehouses` - страница с заявками, разделенные по складам
- `app/(root)/(railway)/railway-basket` - страница с загрузочными листами жд
- `app/(root)/(railway)/railway-archive` - страница с архивными заявками жд

- `app/(root)/(spec)` - страница для видимого разделения, внутри находятся все страницы, которые относятся к модулю Спецтехника Самоходы
- `app/(root)/(spec)/spec-proposals` - страница с заявками спецтехника
- `app/(root)/(spec)/spec-warehouses` - страница с заявками, разделенные по складам
- `app/(root)/(spec)/spec-basket` - страница с загрузочными листами спецтехника
- `app/(root)/(spec)/spec-archive` - страница с архивными заявками спецтехника

### Сервисы (папка services)

- `api.js`- конфигурация API RTK Query. Здесь есть baseUrl для подключения к бэкенду.
- все остальные файлы в папке - добавление запросов к API RTK Query

### Слайсы (папка slices)

- все слайсы, в проекте применяются не так часто, многие состояния используются через RTK Query

### Store (папка store)

- `store.js` - конфигурация Redux Toolkit

### Providers (папка providers)

- `ReduxProvider.js` - провайдер для Redux Toolkit
- `withAuth.js` - провайдер для аутентификации пользователя, все страницы в папке (root) находятся внутри этого провайдера через layout.js

### Middleware (папка middleware)

- `auth.js` - middleware для добавления токена в локальное хранилище после успешного входа

### Helpers (папка helpers)

- `exctractWarehouseNameFromStatus.js` - вспомогательная функция для получения названия склада по его статусу
- `formatDate.js` - вспомогательная функция для форматирования даты
- `formatMoney.js` - вспомогательная функция для форматирования суммы
- `formatNumber.js` - вспомогательная функция для форматирования числа
- `getRole.js` - вспомогательная функция для перевода роли, например "admin" = Администратор
- `getStringPathname` - вспомогательная функция для получения названия страницы (Заявки, Компании и т.д) через ссылку

### Data (папка data)

Здесь хранятся папки с дефолтными значениями некоторых данных, каждый разделен по модулям. Например, какие колонки у заявки, также есть функция для форматирования данных перед отправкой в таблицу.

### Shared (папка shared)

Папка без особой логики, здесь только элементы для UI. Из сложных компонентов есть только папка Table.

## Компоненты (папка components)

Глобальная информация по структуре:

- В целом компоненты являются похожими, в самой папке находятся папки для главного модуля Авто. Остальные разделены уже внутри: spec, railway. Они хранят в себе похожие компоненты (как у авто).

- Каждая попка, которая относится к таблице хранит в себе `Module`Table, который является главным компонентом таблицы. Каждая таблица хранит в себе `Module`Header, где хранятся заголовок, поиск, фильтрация (если есть) и выбранные колонки, получает пропсы из компонента `Module`Table: группирование, настройки для групп, все колонки, выбранные колонки, поиск, названия колонок. Также через этот компонент отправляются данные для переиспользуемого компонента `Table` в папке shared.

- Компоненты Формы. Получают пропсы в виде к какой форме они относятся (редактирование, создание)

- loadingListExcel - создает excel-файл и дает возможность для предпросмотра. Принимает данные, которые нужно отобразить, название модуля и даты периода.

- proposalExcelGeneral - создает excel-файл по периодам, является глобальным, в интерфейсе стоит сверху с кнопкой "Скачать в Excel". Этот компонент принимает в себя данные и названия колонок, поэтому может применяться не только для заявок!
